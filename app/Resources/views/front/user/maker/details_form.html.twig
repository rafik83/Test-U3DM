{% extends 'front/user/base.html.twig' %}

{% form_theme form _self %}

{% if form.portfolioImages is defined %}
    {# we do not want to use the bootstrap theme for the portfolio nested forms #}
    {% form_theme form.portfolioImages with ['form/jquery.collection.html.twig'] only %}
{% endif %}

{% block appbundle_user_maker_portfolio_image_widget %}
    <div class="row">
        <div class="col-sm-8">
            {{ form_errors(form.pictureFile) }}
            {{ form_widget(form.pictureFile) }}
            {{ form_widget(form.position) }}
        </div>
        <div class="col-sm-4">
            <a href="#" class="collection-remove btn-sm"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span></a>
            <a href="#" class="collection-up btn-sm"><span class="glyphicon glyphicon-arrow-up" aria-hidden="true"></span></a>
            <a href="#" class="collection-down btn-sm"><span class="glyphicon glyphicon-arrow-down" aria-hidden="true"></span></a>
            <a href="#" class="collection-add btn-sm"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span></a>
        </div>
    </div>
{% endblock %}

{% block user_content %}
    <h1>{{ 'user.dashboard.menu.profile.maker.details.edit'|trans }}</h1>
    {{ form_start(form) }}
        {{ form_errors(form) }}
        <div class="form-group{% if not app.user.maker.enabled %} hidden{% endif %}">
            <div class="col-sm-offset-2 col-sm-10">
                {{ form_row(form.available) }}
            </div>
        </div>
        {{ form_row(form.company) }}
        {{ form_row(form.bio) }}
        {{ form_row(form.profilePictureFile) }}

        <div class="form-group">
            <label class="col-sm-2 control-label required">Portfolio</label>
            <div class="col-sm-10">
                {{ form_widget(form.portfolioImages) }}
            </div>
        </div>
        <div class="form-group">
            <div class="col-sm-offset-2 col-sm-10">
                {{ form_row(form.pickup) }}
            </div>
        </div>
        {{ form_row(form.pickupAddress) }}
        <div class="text-right">
            <input type="hidden" id="current_user" value="{{ maker.user.firstname }}" />
            <button type="submit" id="btn_submit" class="btn btn-rounded">{{ 'form.save'|trans }}</button>
        </div>
    {{ form_end(form) }}
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script type="text/javascript" src="{{ asset('assets/front/js/jquery.collection.js') }}"></script>
    <script type="text/javascript">
        $(document).ready(function() {
            $('.portfolio-collection').collection({
                position_field_selector: '.image-position'
            });
            $('.profile-logo').parent().find('img').css('border-radius', '150px');
            var pickupBox = $('#maker_details_pickup');
            togglePickupAddress(pickupBox);
            pickupBox.change(function() {
                togglePickupAddress($(this));
            });

            $("#btn_submit").click(function (e) {
                var currentUser = $("#current_user").val();
                if ($('#maker_details_company').length == 1){
                    gtag_report_event(currentUser,'account','field_error');
                }
                if ($('#maker_details_pickupAddress_firstname').length == 1){
                    gtag_report_event(currentUser,'account','field_error');
                }
                if ($('#maker_details_pickupAddress_lastname').length == 1){
                    gtag_report_event(currentUser,'account','field_error');
                }
                if ($('#maker_details_pickupAddress_company').length == 1){
                    gtag_report_event(currentUser,'account','field_error');
                }
                if ($('#maker_details_pickupAddress_street1').length == 1){
                    gtag_report_event(currentUser,'account','field_error');
                }
                if ($('#maker_details_pickupAddress_zipcode').length == 1){
                    gtag_report_event(currentUser,'account','field_error');
                }
                if ($('#maker_details_pickupAddress_city').length == 1){
                    gtag_report_event(currentUser,'account','field_error');
                }
                if ($('#maker_details_pickupAddress_country').length == 1){
                    gtag_report_event(currentUser,'account','field_error');
                }

                if ($('#maker_details_bio').length == 1){
                    gtag_report_event(currentUser,'account','field_error');
                }

                if ($('#maker_details_profilePictureFile_file').clickable == undefined) {
                    gtag_report_event(currentUser, 'account', 'field_error');

                }

                if ($('#maker_details_portfolioImages_0_pictureFile_file').clickable == undefined) {
                    gtag_report_event(currentUser, 'account', 'field_error');

                }
                if ($('#maker_details_portfolioImages_1_pictureFile_file').clickable == undefined) {
                    gtag_report_event(currentUser, 'account', 'field_error');

                }
                if ($('#maker_details_portfolioImages_2_pictureFile_file').clickable == undefined) {
                    gtag_report_event(currentUser, 'account', 'field_error');

                }
                if ($('#maker_details_portfolioImages_3_pictureFile_file').clickable == undefined) {
                    gtag_report_event(currentUser, 'account', 'field_error');

                }
                if ($('#maker_details_portfolioImages_4_pictureFile_file').clickable == undefined) {
                    gtag_report_event(currentUser, 'account', 'field_error');

                }
                if ($('#maker_details_portfolioImages_5_pictureFile_file').clickable == undefined) {
                    gtag_report_event(currentUser, 'account', 'field_error');

                }

            })

            })








        function togglePickupAddress(pickupBox) {
            if (pickupBox.prop('checked')) {
                $('#maker_details_pickupAddress').parent().parent().show();
            } else {
                $('#maker_details_pickupAddress').parent().parent().hide();
            }
        }
    </script>
{% endblock %}